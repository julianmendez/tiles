
class UnbiasednessPipelineSpec ()
  extends
    AnyFunSuite

  check [A : Type] (obtained : A) (expected : A) : org.scalatest.compatible.Assertion =
    assert (obtained == expected)

  ex = ScoringScenarioExample .mk

  unbiasedness_pipeline =
    UnbiasednessPipeline .mk (
      ex .positive_value) (
      ex .result_function) (
      ex .protected_attribute_function
    )

  test ("coefficient of a completely unbiased sample") (
    check (
      obtained := unbiasedness_pipeline .apply (ex .initial_unbiased) .contents
    ) (
      expected := None
    )
  )

  test ("coefficient of mostly unbiased sample") (
    check (
      obtained := unbiasedness_pipeline .apply (ex .initial_mostly_unbiased) .contents
    ) (
      expected := Some (0.08)
    )
  )

  test ("coefficient of biased sample") (
    check (
      obtained := unbiasedness_pipeline .apply (ex .initial_biased) .contents
    ) (
      expected := Some (0.42)
    )
  )

end

