
class ScoringToolSpec ()
  extends
    AnyFunSuite

  check [A : Type] (obtained : A) (expected : A) : org.scalatest.compatible.Assertion =
    assert (obtained == expected)

  example_xlist_1 : Seq [Number] = Seq (1 , 3 , 5 , 8)

  example_ylist_1 : Seq [Number] = Seq (1 , 3 , 5 , 8)

  instance_1 : SeqPair = SeqPair .mk (example_xlist_1) (example_ylist_1)

  _mt : MathTool = MathTool .mk

  _mc : ScoringCategory = ScoringCategory .mk

  test ("sum") (
    check (
      obtained := _mt .sum (example_xlist_1)
    ) (
      expected := 17
    )
  )

  test ("average") (
    check (
      obtained := _mt .average (example_xlist_1)
    ) (
      expected := 4.25
    )
  )

  test ("categorize") (
    check (
      obtained := _mc .categorize (0.2)
    ) (
      expected := _mc .weak_positive_correlation
    )
  )

  example_xlist_2 : Seq [Number] = Seq (43 , 21 , 25 , 42 , 57 , 59)

  example_ylist_2 : Seq [Number] = Seq (99 , 65 , 79 , 75 , 87 , 81)

  instance_2 : SeqPair = SeqPair .mk (example_xlist_2) (example_ylist_2)

  test ("coefficient v1") (
    check (
      obtained := MathTool .mk .is_within (PearsonCorrDirect .mk .coefficient (instance_2) ) (0.529808901) (0.000000001)
    ) (
      expected := true
    )
  )

  test ("coefficient v2") (
    check (
      obtained := MathTool .mk .is_within (PearsonCorrCovariance .mk .coefficient (instance_2) ) (0.529808901) (0.000000001)
    ) (
      expected := true
    )
  )

  example_xlist_3 : Seq [Number] = Seq (10 , 20 , 30 , 40 , 50)

  example_ylist_3 : Seq [Number] = Seq (15 , 25 , 35 , 45 , 55)

  instance_3 : SeqPair = SeqPair .mk (example_xlist_3) (example_ylist_3)

  test ("coefficient v1 - perfect positive") (
    check (
      obtained := MathTool .mk .is_within (PearsonCorrDirect .mk .coefficient (instance_3) ) (1.0) (0.000001)
    ) (
      expected := true
    )
  )

  test ("coefficient v2 - perfect positive") (
    check (
      obtained := MathTool .mk .is_within (PearsonCorrCovariance .mk .coefficient (instance_3) ) (1.0) (0.000001)
    ) (
      expected := true
    )
  )


  example_xlist_4 : Seq [Number] = Seq (1 , 2 , 3 , 4 , 5)

  example_ylist_4 : Seq [Number] = Seq (10 , 8 , 6 , 4 , 2)

  instance_4 : SeqPair = SeqPair .mk (example_xlist_4) (example_ylist_4)

  test ("coefficient v1 - perfect negative") (
    check (
      obtained := MathTool .mk .is_within (PearsonCorrDirect .mk .coefficient (instance_4) ) (-1.0) (0.000001)
    ) (
      expected := true
    )
  )

  test ("coefficient v2 - perfect negative") (
    check (
      obtained := MathTool .mk .is_within (PearsonCorrCovariance .mk .coefficient (instance_4) ) (-1.0) (0.000001)
    ) (
      expected := true
    )
  )


  example_xlist_5 : Seq [Number] = Seq (1 , 2 , 3 , 4 , 5)

  example_ylist_5 : Seq [Number] = Seq (7 , 3 , 6 , 2 , 8)

  instance_5 : SeqPair = SeqPair .mk (example_xlist_5) (example_ylist_5)

  test ("coefficient v1 - no correlation") (
    check (
      obtained := MathTool .mk .is_within (PearsonCorrDirect .mk .coefficient (instance_5) ) (0.061084722) (0.000000001)
    ) (
      expected := true
    )
  )

  test ("coefficient v2 - no correlation") (
    check (
      obtained := MathTool .mk .is_within (PearsonCorrCovariance .mk .coefficient (instance_5) ) (0.061084722) (0.000000001)
    ) (
      expected := true
    )
  )

end ScoringToolSpec

